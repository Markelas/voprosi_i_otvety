## üîÑ Retry –º–µ—Ö–∞–Ω–∏–∑–º - fetchWithRetry(url, retries)

### –ó–∞–¥–∞—á–∞

–ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `fetchWithRetry(url, retries)`, –∫–æ—Ç–æ—Ä–∞—è –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å fetch –∑–∞–ø—Ä–æ—Å. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –µ—â—ë `retries` —Ä–∞–∑. –ú–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ –¥–µ–ª–∞–π—Ç–µ –ø–∞—É–∑—É –≤ 1 —Å–µ–∫—É–Ω–¥—É. –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã, –≤—ã–±—Ä–æ—Å–∏—Ç–µ –æ—à–∏–±–∫—É.

---

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

–í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ API –º–æ–≥—É—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–∞–¥–∞—Ç—å (—Å–µ—Ç–µ–≤—ã–µ —Å–±–æ–∏, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞). Retry –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å, –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

---

### –†–µ—à–µ–Ω–∏–µ:

```js
async function fetchWithRetry(url, retries) {
    for (let i = 0; i <= retries; i++) {
        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return await response.json();
        } catch (error) {
            // –ï—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
            if (i === retries) {
                throw new Error(`–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã: ${error.message}`);
            }
            // –ñ–¥—ë–º 1 —Å–µ–∫—É–Ω–¥—É –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–æ–π
            await new Promise(resolve => setTimeout(resolve, 1000));
        }
    }
}
```

---

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```js
try {
    const data = await fetchWithRetry('https://api.example.com/data', 3);
    console.log(data);
} catch (error) {
    console.log('–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã:', error.message);
}
```

---

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

1. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ü–∏–∫–ª `for` –¥–ª—è –ø–æ–ø—ã—Ç–æ–∫ (–æ—Ç 0 –¥–æ `retries` –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)
2. –í `try/catch` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º `fetch`
3. –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ—Å–ª–µ–¥–Ω—è—è –ª–∏ —ç—Ç–æ –ø–æ–ø—ã—Ç–∫–∞
4. –ï—Å–ª–∏ –Ω–µ –ø–æ—Å–ª–µ–¥–Ω—è—è ‚Äî –∂–¥—ë–º 1 —Å–µ–∫—É–Ω–¥—É —á–µ—Ä–µ–∑ `delay` –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º
5. –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã ‚Äî –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É

---

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ):

```js
async function fetchWithRetry(url, retries) {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return await response.json();
    } catch (error) {
        if (retries === 0) {
            throw new Error(`–í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã: ${error.message}`);
        }
        // –ñ–¥—ë–º 1 —Å–µ–∫—É–Ω–¥—É –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º —Å —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ø—ã—Ç–æ–∫
        await new Promise(resolve => setTimeout(resolve, 1000));
        return fetchWithRetry(url, retries - 1);
    }
}
```

---

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫:** `retries` ‚Äî —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (–Ω–µ –≤–∫–ª—é—á–∞—è –ø–µ—Ä–≤—É—é)
- **–ó–∞–¥–µ—Ä–∂–∫–∞:** 1 —Å–µ–∫—É–Ω–¥–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫ —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏, —Ç–∞–∫ –∏ HTTP —Å—Ç–∞—Ç—É—Å—ã
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–∑—É

