# REST API

## Что такое REST API

**REST** (Representational State Transfer) — это **архитектурный стиль** для проектирования сетевых API, а не протокол и не стандарт.  
**REST API** — API, построенное по принципам REST: ресурсы, HTTP-методы, статусы, без состояния (stateless).

---

### Основные принципы REST

| Принцип | Суть |
|--------|------|
| **Ресурсы** | Всё представляется как ресурс с уникальным URI (`/users`, `/products/1`) |
| **HTTP-методы** | Операции над ресурсом — через GET, POST, PUT, PATCH, DELETE |
| **Stateless** | Сервер не хранит состояние клиента между запросами; каждый запрос самодостаточен |
| **Единообразие интерфейса** | Один и тот же подход ко всем ресурсам (URL + метод + тело при необходимости) |
| **Кэшируемость** | Ответы могут кэшироваться (заголовки `Cache-Control`, `ETag`) |

---

### Ресурсы и URI

- Ресурс — сущность: пользователь, заказ, товар.
- **URI** идентифицирует ресурс: `/users`, `/users/42`, `/orders/100/items`.
- Имена — существительные во множественном числе: `/users`, а не `/getUser`.
- Иерархия через путь: `/users/1/orders` — заказы пользователя 1.

---

### Методы и CRUD

| Метод | Действие | Пример URI | Типичный статус |
|-------|----------|------------|-----------------|
| **GET** | Получить (одно или список) | `GET /users`, `GET /users/1` | 200, 404 |
| **POST** | Создать | `POST /users` | 201 Created |
| **PUT** | Полностью заменить | `PUT /users/1` | 200, 204 |
| **PATCH** | Частично обновить | `PATCH /users/1` | 200 |
| **DELETE** | Удалить | `DELETE /users/1` | 200, 204, 404 |

GET — безопасный и идемпотентный; PUT, DELETE — идемпотентные; POST — не идемпотентный.

---

### Форматы данных

- **Request/Response:** чаще всего **JSON** (`Content-Type: application/json`).
- Реже — XML, Form-urlencoded для форм.
- В запросе: параметры списков и фильтров — в **query**: `GET /users?page=1&limit=10&role=admin`.

---

### HTTP-статусы (что важно для REST)

| Код | Когда использовать |
|-----|--------------------|
| **200 OK** | Успешный GET, PUT, PATCH |
| **201 Created** | Успешное создание (POST), в ответе часто заголовок `Location` с URI созданного ресурса |
| **204 No Content** | Успех без тела (часто DELETE, иногда PUT/PATCH) |
| **400 Bad Request** | Невалидные данные в теле или параметрах |
| **401 Unauthorized** | Нет или неверная аутентификация |
| **403 Forbidden** | Доступ к ресурсу запрещён |
| **404 Not Found** | Ресурс не найден |
| **409 Conflict** | Конфликт при создании/обновлении (дубликат, несовпадение версий) |
| **500 Internal Server Error** | Ошибка на сервере |
| **503 Service Unavailable** | Сервис временно недоступен |

---

### Идемпотентность и безопасность

- **Безопасный** метод — не меняет данные на сервере (GET, HEAD, OPTIONS).
- **Идемпотентный** — повторный одинаковый запрос даёт тот же результат: GET, PUT, DELETE — идемпотентны; POST — как правило, нет (каждый вызов может создавать новый ресурс).

---

### Типичные вопросы на собеседовании

| Вопрос | Краткий ответ |
|--------|----------------|
| Что такое REST? | Архитектурный стиль: ресурсы по URI, операции через HTTP-методы, stateless, единообразный интерфейс. |
| REST — это протокол? | Нет, это стиль проектирования. Использует HTTP. |
| В чём разница между PUT и PATCH? | PUT — замена ресурса целиком, PATCH — частичное обновление полей. |
| Что такое stateless в REST? | Сервер не хранит сессию клиента; каждый запрос содержит всё необходимое (токен, заголовки, тело). |
| Как передавать аутентификацию? | Часто **Bearer-токен** в заголовке `Authorization: Bearer <token>` или cookies. |
| Что такое версионирование API? | Отдельный путь или заголовок: `/v1/users`, `/v2/users` или `Accept: application/vnd.api.v1+json`. |

---

### Версионирование

- В **URL**: `/v1/users`, `/v2/users`.
- В **заголовке**: `Accept: application/vnd.company.v1+json`.
- Цель — не ломать старых клиентов при изменении контракта.

---

### Кратко для ответа на собеседовании

REST API — это API по принципам REST: ресурсы задаются URI, действия — HTTP-методами (GET, POST, PUT, PATCH, DELETE), обмен обычно в JSON, без сохранения состояния на сервере. Важно корректно использовать методы, статусы и единообразные URI.
