# Элементы \<audio\> и \<video\>

## Краткий ответ для собеседования

**\<audio\>** и **\<video\>** — встроенные HTML5-элементы для воспроизведения звука и видео без плагинов. Оба наследуют общий API (**HTMLMediaElement**): `play()`, `pause()`, `currentTime`, `volume`, события `loadeddata`, `ended`, `error`. Атрибуты: `controls` (показ плеера), `autoplay`, `loop`, `muted`, `preload` (none/metadata/auto). Источник задаётся через атрибут `src` или вложенные **\<source\>** с разными форматами — браузер выберет первый поддерживаемый. Поддержка форматов различается (MP3, WebM, Ogg для audio; MP4, WebM для video); для автовоспроизведения в большинстве браузеров нужен **muted**. На собеседовании могут спросить про атрибуты, разницу между `preload` и загрузкой, ограничения autoplay и как управлять воспроизведением через JS.

---

## \<audio\>

### Назначение

Элемент **\<audio\>** встраивает аудиоплеер на страницу. Браузер сам отрисовывает контролы (если указан `controls`), загружает и воспроизводит звук. Плагины (Flash и т.п.) не нужны.

### Основные атрибуты

| Атрибут | Описание |
|--------|----------|
| **src** | URL аудиофайла (можно задать один источник прямо в теге). |
| **controls** | Показывает встроенные кнопки воспроизведения, громкости, прогресс. |
| **autoplay** | Начать воспроизведение после загрузки. Во многих браузерах блокируется без **muted** (политика autoplay). |
| **loop** | Зациклить воспроизведение. |
| **muted** | Без звука по умолчанию. Часто нужен вместе с autoplay, чтобы браузер разрешил старт. |
| **preload** | `none` — не загружать до play; `metadata` — только метаданные (длительность и т.д.); `auto` — браузер может подгружать данные заранее. |

### Несколько форматов через \<source\>

Браузеры поддерживают разные кодеки (MP3 везде, Ogg/WebM — не везде). Можно указать несколько вариантов внутри \<audio\> через **\<source src="..." type="...">** — браузер выберет первый поддерживаемый. В конце оставляют fallback-контент или текст для старых браузеров.

**Особенности:** без `controls` элемент невидим (можно управлять только через JS). Для автовоспроизведения в мобильных и десктопных браузерах обычно требуется **muted**.

---

## \<video\>

### Назначение

Элемент **\<video\>** встраивает видеоплеер. По идее тот же подход, что и у \<audio\>: встроенные контролы, загрузка и воспроизведение без плагинов.

### Основные атрибуты

Те же, что у \<audio\>, плюс: **width / height**, **poster**, **playsinline** (важно на iOS).

Как и у \<audio\>, источник можно задать через **src** или несколько **\<source\>** с разными форматами (например, MP4 и WebM).

**Особенности:** без `controls` видео всё равно видно (первый кадр или poster). На мобильных часто нужен **playsinline**. Autoplay с звуком почти везде блокируется; с **muted** обычно разрешён.

---

## Общий API (HTMLMediaElement)

И \<audio\>, и \<video\> в DOM — это объекты с общим интерфейсом **HTMLMediaElement**. Основное: **play()**, **pause()**, **currentTime**, **duration**, **volume**, **muted**, **paused**; события **loadeddata**, **ended**, **error**, **canplay** / **canplaythrough**.

---

## Управление с помощью JS

Получить элемент можно через **querySelector** / **getElementById** (например, по `id` у тега \<audio\> или \<video\>). Дальше управление идёт через методы и свойства этого объекта.

**Методы:**
- **play()** — запустить воспроизведение; возвращает **Promise** (reject, если автовоспроизведение заблокировано политикой браузера).
- **pause()** — поставить на паузу.

**Свойства (чтение и при необходимости запись):**
- **currentTime** — текущая позиция в секундах; запись перематывает на нужное место.
- **duration** — длительность в секундах (доступна после загрузки метаданных, иначе NaN).
- **volume** — громкость от 0 до 1.
- **muted** — булево; true/false для отключения/включения звука.
- **paused** — булево; true, если воспроизведение на паузе.

**События:** на элемент вешают слушатели (**addEventListener**): **loadeddata** — достаточно данных для старта, **ended** — воспроизведение закончилось, **error** — ошибка загрузки/воспроизведения, **timeupdate** — обновление текущей позиции (удобно для отрисовки прогресс-бара). При необходимости обрабатывают **canplay** / **canplaythrough**.

Пример: по клику на кнопку вызвать `video.play()` или `video.pause()`; для перемотки задать `video.currentTime = 30` (на 30-ю секунду). Код сводится к обращению к элементу и вызову метода или изменению свойства.

---

## Форматы и кодеки

- **Audio:** MP3 (почти везде), Ogg Vorbis, WebM, AAC.
- **Video:** MP4 (H.264) — широкая поддержка; WebM (VP8/VP9) — Chrome, Firefox.

Через \<source\> задают несколько форматов; браузер выбирает подходящий.

---

## Autoplay и политики браузеров

**autoplay с muted** — часто разрешён. **autoplay со звуком** — часто блокируется до взаимодействия пользователя. На собеседовании: «Чтобы autoplay сработал, обычно нужен muted.»

---

## Что могут спросить на собеседовании

| Вопрос | Краткий ответ |
|--------|----------------|
| Для чего нужны \<audio\> и \<video\>? | Встроенное воспроизведение звука и видео без плагинов; общий API (HTMLMediaElement). |
| Какие основные атрибуты? | controls, autoplay, loop, muted, preload; у video ещё width, height, poster, playsinline. |
| Зачем несколько \<source\> внутри? | Разные форматы/кодеки; браузер выбирает первый поддерживаемый. |
| Что такое preload? | Подсказка браузеру: не загружать (none), только метаданные (metadata) или подгружать заранее (auto). |
| Почему autoplay не срабатывает? | Политика браузеров: часто разрешён только с muted или после взаимодействия пользователя. |
| Чем управлять воспроизведением из JS? | Методы play(), pause(); свойства currentTime, volume, muted; события loadeddata, ended, error. |
| Зачем video с muted при autoplay? | Чтобы браузер не блокировал автовоспроизведение по политике autoplay. |
| Что такое playsinline у video? | На iOS видео воспроизводится внутри страницы, а не сразу в полноэкранном режиме. |

---

## Кратко для ответа

**\<audio\>** и **\<video\>** — элементы HTML5 для звука и видео с общим API. Атрибуты: controls, autoplay, loop, muted, preload; у video — poster, playsinline. Несколько форматов задают через \<source\>. Autoplay со звуком часто блокируется; с muted обычно разрешён. Управление через JS — методы и свойства HTMLMediaElement.
