# Схлопывание марджинов (margin collapsing)

## Краткий ответ для собеседования

**Схлопывание марджинов (margin collapsing)** — когда два вертикальных отступов (margin-top и margin-bottom) соседних блоков **не складываются**, а браузер берёт **один** — больший по модулю. Так верхний и нижний отступы «схлопываются» в один. Происходит только с **вертикальными** отступами у **блочных** элементов в **нормальном потоке**. Не схлопываются: горизонтальные отступы; отступы у элементов с float, flex, grid, position: absolute/fixed; отступы между родителем и потомком, если у родителя есть padding/border или overflow не visible. Зачем нужно: предсказуемая вёрстка текстовых блоков (параграфы, заголовки). Чтобы «развести» отступы: добавить родителю padding/border или overflow: hidden/auto, обернуть в flex/grid, использовать один margin вместо двух.

---

## Что это такое

**Схлопывание марджинов** — поведение блочной модели в CSS: два **вертикальных** отступа (margin-top одного элемента и margin-bottom другого), которые «соприкасаются» по вертикали, не складываются. Браузер оставляет между элементами **один** отступ — равный **большему** из двух (если один отрицательный — правила сложнее, но идея та же: они объединяются в один результирующий отступ).

Простыми словами: у одного блока margin-bottom: 20px, у следующего margin-top: 30px. Ожидание «20 + 30 = 50px» неверно: между ними будет **30px** (больший отступ «побеждает»). Отступы как бы **схлопываются** в один.

---

## Когда происходит

- Только **вертикальные** отступы (margin-top, margin-bottom). Горизонтальные (margin-left, margin-right) **не** схлопываются.
- Только у **блочных** элементов в **нормальном потоке** документа (не у inline, не у элементов с float, flex, grid, position: absolute/fixed).
- Между **соседними** блоками: нижний отступ первого и верхний отступ второго.
- Между **родителем и первым/последним потомком**: если у родителя нет padding/border сверху или снизу и нет overflow (кроме visible), то margin потомка может «вылезти» наружу и схлопнуться с margin родителя или соседнего блока — визуально отступ оказывается у родителя.

---

## Когда не происходит

- **Горизонтальные** отступы — не схлопываются, складываются.
- У элемента заданы **float**, **position: absolute** или **fixed** — его margin не схлопывается с соседями.
- Родитель — **flex** или **grid** контейнер — отступы потомков не схлопываются с margin родителя (flex/grid создаёт свой контекст).
- У родителя есть **padding** или **border** сверху/снизу — margin потомка не «пробивает» родителя и не схлопывается с внешним миром.
- У родителя **overflow**, отличный от **visible** (например, hidden, auto, scroll) — создаётся новый блоковый контекст, margin потомка не схлопывается с margin родителя.

На собеседовании можно сказать: «Схлопывание отключается при padding/border у родителя, при overflow не visible, при flex/grid и при выведении элемента из потока (float, absolute).»

---

## Зачем это нужно

Исторически — чтобы вёрстка **текста** (параграфы, заголовки) вела себя предсказуемо: между двумя параграфами с margin получается один зазор, а не сумма двух. Так проще верстать документы без лишних «двойных» отступов.

---

## Как «отменить» схлопывание, если мешает

- Добавить родителю **padding** или **border** (хотя бы 1px) сверху/снизу — margin потомка перестанет схлопываться с внешним margin.
- Задать родителю **overflow: hidden** (или auto) — создаётся новый контекст, схлопывание с родителем не происходит.
- Сделать родителя **flex** или **grid** — отступы потомков не схлопываются с margin родителя.
- Оставить **один** margin (только top или только bottom у блоков), чтобы не полагаться на схлопывание и контролировать зазоры явно.

---

## Вопросы на собеседовании

| Вопрос | Краткий ответ |
|--------|----------------|
| Что такое схлопывание марджинов? | Два вертикальных margin соседних блоков не складываются — браузер оставляет один, больший по модулю. |
| Какие отступы схлопываются? | Только вертикальные (margin-top, margin-bottom) у блочных элементов в нормальном потоке. |
| Схлопываются ли горизонтальные margin? | Нет, горизонтальные складываются. |
| Как отменить схлопывание? | Padding или border у родителя, overflow: hidden/auto, flex/grid у родителя, или не использовать оба margin (только один). |
| Почему у родителя и потомка отступ «уезжает» вверх? | Margin первого потомка может схлопнуться с margin родителя, если у родителя нет padding/border сверху и overflow: visible. |

---

## Кратко для ответа

**Схлопывание марджинов** — вертикальные margin двух блоков в нормальном потоке объединяются в один (равный большему). Горизонтальные не схлопываются. Не происходит при padding/border у родителя, при overflow не visible, при flex/grid и при float/absolute. Чтобы убрать схлопывание: добавить родителю padding/border или overflow: hidden, либо использовать flex/grid.
