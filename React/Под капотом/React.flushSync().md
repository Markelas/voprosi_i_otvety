
## ‚ö° React.flushSync ‚Äî —á—Ç–æ —ç—Ç–æ –∏ –∑–∞—á–µ–º

**flushSync(callback)** ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ –∏–∑ **react-dom**, –∫–æ—Ç–æ—Ä—ã–π _–∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç React –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ_, —Å—Ä–∞–∑—É, –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—è –µ–≥–æ –≤ –æ—á–µ—Ä–µ–¥—å.

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é React **–±–∞—Ç—á–∏—Ç** (–æ–±—ä–µ–¥–∏–Ω—è–µ—Ç) setState –≤ –æ–¥–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ –∏–Ω–æ–≥–¥–∞ —ç—Ç–æ –º–µ—à–∞–µ—Ç, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã UI –æ–±–Ω–æ–≤–∏–ª—Å—è **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ**.

---

## üß© –ó–∞—á–µ–º –Ω—É–∂–µ–Ω flushSync

### 1. üî• –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ DOM

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã React –æ–±–Ω–æ–≤–∏–ª DOM _–¥–æ_ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ–¥–∞.

–ü—Ä–∏–º–µ—Ä –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏:  
‚Äì –∏–∑–º–µ—Ä–∏—Ç—å DOM –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è  
‚Äì –ø—Ä–æ—Å–∫—Ä–æ–ª–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è  
‚Äì –ø–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É/–≤—ã—Å–æ—Ç—É  
‚Äì –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é

### 2. üö´ –û–±–æ–π—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –±–∞—Ç—á–∏–Ω–≥-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

React 18 –≤–∫–ª—é—á–∞–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π batching –¥–∞–∂–µ –≤ –ø—Ä–æ–º–∏—Å–∞—Ö**.

–ò–Ω–æ–≥–¥–∞ —ç—Ç–æ –ª–æ–º–∞–µ—Ç –ª–æ–≥–∏–∫—É, –æ—Å–æ–±–µ–Ω–Ω–æ:

- –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å setState ‚Üí –ø–æ—Ç–æ–º —Å—Ä–∞–∑—É —Å—á–∏—Ç–∞—Ç—å DOM
    
- –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–æ—Ä—Ç–∞–ª–∞–º–∏
    
- –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏
    

**flushSync –æ—Ç–∫–ª—é—á–∞–µ—Ç –±–∞—Ç—á–∏–Ω–≥ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–ª–æ–∫–∞.**

---

## üìå –ü—Ä–∏–º–µ—Ä (—Ç–∏–ø–∏—á–Ω–∞—è –∑–∞–¥–∞—á–∞)

–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–Ω–∞–Ω–∏—è—Ö React.

```jsx
import { flushSync } from "react-dom";

function Example() {
  const ref = useRef(null);
  const [items, setItems] = useState([]);

  function addItem() {
    flushSync(() => {
      setItems(i => [...i, "new"]);
    });

    // –∑–¥–µ—Å—å DOM —É–∂–µ –æ–±–Ω–æ–≤–ª—ë–Ω
    ref.current.scrollIntoView();
  }

  return (
    <div>
      {items.map((i, idx) => (
        <div key={idx} ref={idx === items.length - 1 ? ref : null}>
          {i}
        </div>
      ))}
    </div>
  );
}
```

–ï—Å–ª–∏ –±—ã **flushSync** –Ω–µ –±—ã–ª–æ ‚Äî DOM –æ–±–Ω–æ–≤–∏–ª—Å—è –±—ã –ø–æ–∑–∂–µ, –∏ `scrollIntoView()` –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –±—ã –∫–∞–∫ –Ω—É–∂–Ω–æ.

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã (–æ –∫–æ—Ç–æ—Ä—ã—Ö —Å–ø—Ä–æ—Å–∏—Ç –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä)

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–¥–∫–æ

flushSync **–¥–æ—Ä–æ–≥–æ–π** ‚Äî –æ–Ω –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç React **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ** –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–Ω–¥–µ—Ä ‚Üí —Å–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

### 2. –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

–í React 18 Concurrent Mode _–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º_ flushSync —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞.  
–≠—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –∞ –Ω–µ –ø—Ä–∞–≤–∏–ª–æ.

### 3. –ù–µ –æ—Ç–º–µ–Ω—è–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ concurrent rendering

–û–Ω –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∞–µ—Ç _–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ_ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º.

### 4. –ù–µ —Ä–µ—à–∞–µ—Ç –≥–æ–Ω–∫–∏ –¥–∞–Ω–Ω—ã—Ö

–û–Ω –ª–∏—à—å –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç React –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Å–µ–π—á–∞—Å, –Ω–æ **–Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç**, —á—Ç–æ —Å–ª–µ–¥—É—é—â–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –ø–µ—Ä–µ–±—å—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### 5. –ù–µ –Ω–∞–¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏

–≠—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É—Ä–æ–≤–Ω—è ¬´–∫—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π¬ª, –∫–∞–∫ `forceUpdate()`.

---

## üìù –ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç –¥–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è

> **React.flushSync() –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç React –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ —Å—Ä–∞–∑—É –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å DOM, –æ–±—Ö–æ–¥—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π batching. –ò—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å DOM –ø–µ—Ä–µ–¥ –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º, —Å–∫—Ä–æ–ª–ª–æ–º –∏–ª–∏ —Ä–∞–±–æ—Ç–æ–π —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏. –≠—Ç–æ –¥–æ—Ä–æ–≥–æ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ—á–µ—á–Ω–æ.**
